---
title: 初步认识HA架构
date: 2019-01-05 19:51:40
tags: 架构
categories: 分布式
---

HA（High Availability）架构指的是能够维持分布式系统在少量机器故障下正常运行的架构，它通常是利用冗余（也就是备份）来顶替出现故障的服务。

<!--more-->

学习了相关内容后，我绘制了一幅基本的HA架构图来帮助理解，画图工具：https://www.processon.com

![](https://s2.ax1x.com/2019/05/31/Vlem8J.png)

**Nginx代理层**

通过keeplived虚拟出VIP来提供访问，主机故障就切换成备用机，对用户透明，无感知。



**应用服务层**

Nginx可配置多个应用服务器，出现故障直接把请求分发给其他服务器，Nginx自动完成。

应用服务拆分成微服务，通过SpringCloud/Dubbo等RPC框架进行服务调度和治理，比如Dubbo使用zookeeper作为配置中心，进行服务注册和发现，可以实现服务配置的一致性、负载均衡等。



**数据库**

建立双主复制+keepalived架构保证主库的冗余，其余从库均与VIP建立主从复制，保持集群数据的一致性。

由于web服务基本上都是读多写少，因此与应用服务器的交互实现读写分离：写请求均交给主库处理，读请求给代理（通常是MySQL Proxy、HAProxy等，Nginx想要TCP代理需要另外配置）负载均衡后分发给各个从库，代理服务器同样进行冗余。



通过搭建以上分布式服务环境，我们就能够得到一个基本的高可用集群。